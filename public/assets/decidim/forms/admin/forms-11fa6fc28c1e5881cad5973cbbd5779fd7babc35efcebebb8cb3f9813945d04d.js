"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}();!function(e){var n=function(){function e(){var n=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,e),this.listSelector=n.listSelector,this.minItems=n.minItems,this.hideOnMinItemsOrLessSelector=n.hideOnMinItemsOrLessSelector,this.run()}return _createClass(e,[{key:"run",value:function(){var e=$(this.listSelector),n=e.find(this.hideOnMinItemsOrLessSelector);e.length<=this.minItems?n.hide():n.show()}}]),e}();e.DecidimAdmin=e.DecidimAdmin||{},e.DecidimAdmin.AutoButtonsByMinItemsComponent=n}(window);_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}();!function(e){var n=function(){function e(){var n=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,e),this.wrapperSelector=n.wrapperSelector,this.selectSelector=n.selectSelector,this.listSelector=n.listSelector}return _createClass(e,[{key:"run",value:function(){var e=$(this.listSelector),n=e.parents(this.wrapperSelector).find(this.selectSelector);n.find("option").slice(1).remove();for(var t=2;t<=e.length;t+=1)$('<option value="'+t+'">'+t+"</option>").appendTo(n)}}]),e}();e.DecidimAdmin=e.DecidimAdmin||{},e.DecidimAdmin.AutoSelectOptionsByTotalItemsComponent=n}(window),function(e){var n=e.DecidimAdmin,t=n.AutoLabelByPositionComponent,i=n.AutoButtonsByPositionComponent,o=n.AutoButtonsByMinItemsComponent,r=n.AutoSelectOptionsByTotalItemsComponent,l=n.createFieldDependentInputs,s=n.createDynamicFields,u=n.createSortList,c=e.Decidim.createQuillEditor,a=".questionnaire-questions",d=".questionnaire-question",p="select[name$=\\[question_type\\]]",f=".questionnaire-question-answer-option",m=".questionnaire-question-answer-options",h=".remove-answer-option",S=".questionnaire-question-max-choices",v=new t({listSelector:".questionnaire-question:not(.hidden)",labelSelector:".card-title span:first",onPositionComputed:function(e,n){$(e).find("input[name$=\\[position\\]]").val(n)}}),w=new i({listSelector:".questionnaire-question:not(.hidden)",hideOnFirstSelector:".move-up-question",hideOnLastSelector:".move-down-question"}),q=function(e){return new r({wrapperSelector:d,selectSelector:S+" select",listSelector:"#"+e+" "+m+" .questionnaire-question-answer-option:not(.hidden)"})},C=function(e){return new o({wrapperSelector:d,listSelector:"#"+e+" "+m+" .questionnaire-question-answer-option:not(.hidden)",minItems:2,hideOnMinItemsOrLessSelector:h})},F=function(){u(".questionnaire-questions-list:not(.published)",{handle:".question-divider",placeholder:'<div style="border-style: dashed; border-color: #000"></div>',forcePlaceholderSize:!0,onSortUpdate:function(){v.run()}})},y=function(e){var n=C(e),t=q(e);return s({placeholderId:"questionnaire-question-answer-option-id",wrapperSelector:"#"+e+" "+m,containerSelector:".questionnaire-question-answer-options-list",fieldSelector:f,addFieldButtonSelector:".add-answer-option",removeFieldButtonSelector:h,onAddField:function(){n.run(),t.run()},onRemoveField:function(){n.run(),t.run()}})},b={},I=function(e){var n=e.val();return"single_option"===n||"multiple_option"===n||"sorting"===n},A=function(e){var n=e.attr("id"),t=e.find(p);l({controllerField:t,wrapperSelector:d,dependentFieldsSelector:m,dependentInputSelector:f+" input",enablingCondition:function(e){return I(e)}}),l({controllerField:t,wrapperSelector:d,dependentFieldsSelector:S,dependentInputSelector:"select",enablingCondition:function(e){return"multiple_option"===e.val()}}),b[n]=y(n);var i=b[n],o=function(){I(t)&&(0===t.parents(d).find(f).length&&(i._addField(),i._addField()))};t.on("change",o),o()},B=function(e){"true"===e.find("input[name$=\\[deleted\\]]").val()&&(e.addClass("hidden"),e.hide())};s({placeholderId:"questionnaire-question-id",wrapperSelector:a,containerSelector:".questionnaire-questions-list",fieldSelector:d,addFieldButtonSelector:".add-question",removeFieldButtonSelector:".remove-question",moveUpFieldButtonSelector:".move-up-question",moveDownFieldButtonSelector:".move-down-question",onAddField:function(e){A(e),F(),e.find(".editor-container").each(function(e,n){c(n)}),v.run(),w.run()},onRemoveField:function(e){v.run(),w.run(),e.find(h).each(function(n,t){b[e.attr("id")]._removeField(t)})},onMoveUpField:function(){v.run(),w.run()},onMoveDownField:function(){v.run(),w.run()}}),F(),$(d).each(function(e,n){var t=$(n);B(t),A(t)}),v.run(),w.run()}(window);